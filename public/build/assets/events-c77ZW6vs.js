window.Echo.private("optimus-pro").listenToAll((m,d)=>{if(console.log(m),m.includes("OptimusSignalUpdated")&&document.getElementById("optimus_pro_signals")){const{signals:r}=d;r.forEach(h=>{const{asset:g,asset_clr:_,range:u,fundamental:a,technical:c,sentiment:i,strategy:o}=h,t=g.toLowerCase();document.getElementById(`optimus_pro_signal_${t}_progress`).style.backgroundColor=_;const e=document.getElementById(`optimus_pro_signal_${t}_range`);e.innerText=u;const l=document.getElementById(`optimus_pro_signal_${t}_fundamental`);l.innerText=a;const n=document.getElementById(`optimus_pro_signal_${t}_technical`);n.innerText=c;const s=document.getElementById(`optimus_pro_signal_${t}_sentiment`);s.innerText=i;const p=document.getElementById(`optimus_pro_signal_${t}_strategy`);p.innerText=o,u?e.classList.remove("d-none"):e.classList.add("d-none"),a?(l.classList.remove("d-none"),a=="Buy"?(l.classList.add("btn-primary"),l.classList.remove("btn-danger")):(l.classList.add("btn-danger"),l.classList.remove("btn-primary"))):l.classList.add("d-none"),c?(n.classList.remove("d-none"),c=="Buy"?(n.classList.add("btn-primary"),n.classList.remove("btn-danger")):(n.classList.add("btn-danger"),n.classList.remove("btn-primary"))):n.classList.add("d-none"),i?(s.classList.remove("d-none"),i=="Buy"?(s.classList.add("btn-primary"),s.classList.remove("btn-danger")):(s.classList.add("btn-danger"),s.classList.remove("btn-primary"))):s.classList.add("d-none"),o?(p.classList.remove("d-none"),o.includes("+")?(p.classList.add("btn-primary"),p.classList.remove("btn-info")):(p.classList.add("btn-info"),p.classList.remove("btn-primary"))):p.classList.add("d-none")})}else if(m.includes("TradeBlotterUpdated")&&document.getElementById("optimus_pro_trade_blotters")){const r=document.getElementById("optimus_pro_trade_blotters"),h=document.getElementById("optimus_pro_trade_blotters_placeholder");for(;r.childElementCount>1;)r.removeChild(r.lastChild);const{signals:g}=d;g.forEach(_=>{const{asset:u,time:a,size:c,price:i,sl:o,tp:t,pl:e,size_clr:l,pl_clr:n}=_,s=h.cloneNode(!0);s.classList.remove("d-none"),s.querySelector("#placeholder_trade_blotters_asset").innerText=u,s.querySelector("#placeholder_trade_blotters_time").innerText=a,s.querySelector("#placeholder_trade_blotters_size").innerText=c,s.querySelector("#placeholder_trade_blotters_size").style.color=l,s.querySelector("#placeholder_trade_blotters_price").innerText=i,s.querySelector("#placeholder_trade_blotters_sl").innerText=o,s.querySelector("#placeholder_trade_blotters_tp").innerText=t,s.querySelector("#placeholder_trade_blotters_pl").innerText=e,s.querySelector("#placeholder_trade_blotters_pl").style.color=n,s.removeAttribute("id"),s.querySelectorAll("*").forEach(f=>{f.removeAttribute("id")}),r.appendChild(s)})}else if(m.includes("NewsDataUpdated")&&document.getElementById("optimus_pro_news_data")){const r=document.getElementById("optimus_pro_news_data"),h=document.getElementById("optimus_pro_news_data_placeholder");for(;r.childElementCount>1;)r.removeChild(r.lastChild);const{signals:g}=d;g.forEach(_=>{const{time:u,impact:a,event:c,actual:i,forecast:o,previous:t}=_,e=h.cloneNode(!0);e.classList.remove("d-none"),e.querySelector("#placeholder_news_data_time").innerText=u,e.querySelector("#placeholder_news_data_event").innerText=c,e.querySelector("#placeholder_news_data_actual").innerText=i||"-",e.querySelector("#placeholder_news_data_forecast").innerText=o,e.querySelector("#placeholder_news_data_previous").innerText=t;const l=e.querySelector("#placeholder_news_data_impact");a==3?l.classList.add("text-danger"):a==2?l.classList.add("text-warning"):a==1?l.classList.add("text-success"):l.classList.add("text-muted"),e.removeAttribute("id"),e.querySelectorAll("*").forEach(s=>{s.removeAttribute("id")}),r.appendChild(e)}),$('[data-toggle="tooltip"]').tooltip()}else if(m.includes("CDLSignalUpdated")&&document.getElementById("optimus_pro_candle")){const r=document.getElementById("optimus_pro_candle"),h=document.getElementById("optimus_pro_candle_placeholder");for(;r.childElementCount>1;)r.removeChild(r.lastChild);const{signals:g}=d;g.forEach(c=>{const{cdl:i,cdl_clr:o}=c;if(!i)return;const t=h.cloneNode(!0);t.classList.remove("d-none"),t.querySelector("#optimus_pro_candle_asset").innerText=i,t.querySelector("#optimus_pro_candle_td").style.color=o;const e=t.querySelector("#optimus_pro_candle_signal_text");o=="crimson"?(e.querySelector(".is-bearish").classList.remove("d-none"),e.querySelector(".is-bullish").remove()):o=="forestgreen"&&(e.querySelector(".is-bullish").classList.remove("d-none"),e.querySelector(".is-bearish").remove()),t.removeAttribute("id"),t.querySelectorAll("*").forEach(n=>{n.removeAttribute("id")}),r.appendChild(t)});const _=document.getElementById("optimus_pro_investors"),u=document.getElementById("optimus_pro_investors_placeholder");for(;_.childElementCount>1;)_.removeChild(_.lastChild);const{signals:a}=d;a.forEach(c=>{const{bias:i,bias_clr:o}=c;if(!o)return;const t=u.cloneNode(!0);t.classList.remove("d-none"),t.querySelector("#optimus_pro_investors_asset").innerText=i,t.querySelector("#optimus_pro_investors_td").style.color=o;const e=t.querySelector("#optimus_pro_investors_signal_text");o=="lightsalmon"?(e.querySelector(".is-bearish").classList.remove("d-none"),e.querySelector(".is-bullish").remove(),e.querySelector(".is-neutral").remove()):o=="chartreuse"&&(e.querySelector(".is-bullish").classList.remove("d-none"),e.querySelector(".is-bearish").remove(),e.querySelector(".is-neutral").remove()),t.removeAttribute("id"),t.querySelectorAll("*").forEach(n=>{n.removeAttribute("id")}),_.appendChild(t)})}else if(m.includes("OptimusAlertUpdated")){const{alert:r}=d;toastr.info(r,"Signal Target"),playNotificationSound()}else if(m.includes("OnMessage")){console.log("MessageSent event received:",d);var w=document.querySelector("#kt_drawer_chat_messenger"),v=w.querySelector('[data-kt-element="messages"]'),y,S=v.querySelector('[data-kt-element="template-in"]');y=S.cloneNode(!0),y.classList.remove("d-none");var b=new Date(d.message.created_at);timeStr=b.getHours()+":"+b.getMinutes()+" "+(b.getHours()>=12?"PM":"AM"),y.querySelector('[data-kt-element="message-time"]').innerText=timeStr,y.querySelector('[data-kt-element="message-user"]').innerText=d.message.user.name,y.querySelector('[data-kt-element="message-text"]').innerText=d.message.body,y.removeAttribute("data-kt-element"),v.appendChild(y),v.scrollTop=v.scrollHeight}});window.Echo.private("chat").listen("OnMessage",m=>{});
